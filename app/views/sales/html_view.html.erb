<div class='container'>
  <h3 class='text-center'><%= ENV.fetch('COMPANY_NAME') %> (<%= ENV.fetch('COMPANY_PHONE_NUMBER') %>)</h3>
  <div class='d-flex justify-content-between align-items-center'>
    <h5>Счёт фактура № <%= @sale.id %> от <%= strf_datetime(@sale.updated_at) %></h5>
    <span onclick='window.print()' title='printerda chiqarish'>
      <%= image_tag image_url('printer.png'), style: 'width: 40px; height: 40px; cursor: pointer' %>
    </span>
  </div>
  <ul style='font-size: large; font-weight: bold'>
    <li>Контрагент:  <%= @sale.buyer.name.upcase %> <%= @sale.buyer&.phone_number %></li>
    <li>Долг перед выкупки: <%= num_to_usd(@debt_with_exception) %></li>
    <li>Долг после выкупки: <%= num_to_usd(@total_debt) %></li>
  </ul>
  <table style='font-size: small' class='table table-striped table-sm table-bordered'>
    <thead>
      <tr>
        <th>№</th>
        <th>Наименование</th>
        <th>Цена</th>
        <th>Кол-во</th>
        <th>Сумма</th>
      </tr>
    </thead>
    <tbody>
      <% @sale.product_sells.each_with_index do |product_sell, index| %>
        <tr>
          <td><%= index + 1 %></td>
          <td><%= product_sell.pack.name %></td>
          <td><%= num_to_usd(product_sell.sell_price) %></td>
          <td><%= product_sell.amount %></td>
          <td><%= num_to_usd(product_sell.sell_price * product_sell.amount) %></td>
        </tr>
      <% end %>
      <tr>
        <th></th>
        <th></th>
        <th><%= num_to_usd(@sale.product_sells.sum(:sell_price)) %></th>
        <th><%= num_to_usd(@sale.product_sells.sum(:amount)) %></th>
        <th><%= num_to_usd(@sale.product_sells.sum('sell_price * amount')) %></th>
      </tr>
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function(){
    window.print();
  })
</script>
